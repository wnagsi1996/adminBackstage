(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-518533a4"],{"147d":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-button",{attrs:{type:"primary"},on:{click:t.downTable}},[t._v("下载子单表格")]),n("el-button",{attrs:{type:"primary"},on:{click:t.downTable1}},[t._v("下载产品表格")]),n("div",{staticClass:"tableMag"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"example",data:t.tableData,border:"",stripe:""}},[n("el-table-column",{attrs:{prop:"rid",label:"RID","min-width":"4%"}}),n("el-table-column",{attrs:{prop:"StoreName",label:"Store name","min-width":"6%"}}),n("el-table-column",{attrs:{prop:"Brand",label:"Brand name","min-width":"6%"}}),n("el-table-column",{attrs:{prop:"Asin",label:"ASIN","min-width":"6%"}}),n("el-table-column",{attrs:{prop:"price",label:"Price","min-width":"6%"}}),n("el-table-column",{attrs:{prop:"ProductUrl",label:"The products link","min-width":"10%"}}),n("el-table-column",{attrs:{prop:"pimg",label:"图片","min-width":"3%"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("a",{attrs:{href:t.row.ProductUrl,target:"_blank"}},[n("el-popover",{attrs:{placement:"right",width:"200",trigger:"hover",content:t.row.ProductTitle}},[n("img",{staticStyle:{width:"50px"},attrs:{slot:"reference",src:t.row.ProductImgUrl},slot:"reference"})])],1)]}}])}),n("el-table-column",{attrs:{prop:"quantity",label:"order quantity","min-width":"4%"}}),n("el-table-column",{attrs:{prop:"KeyWord",label:"KeyWord","min-width":"4%"}}),n("el-table-column",{attrs:{prop:"xdyq",label:"Special request","min-width":"5%"}})],1)],1),n("Pagination",{staticClass:"pagination",attrs:{pagination:t.pagination},on:{search:t.search}})],1)},i=[];n("4de4"),n("7db0"),n("ac1f"),n("841c"),n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0"),n("a630"),n("fb6a"),n("b0c0"),n("25f0");function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){if(t){if("string"===typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function l(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return l=t.done,t},e:function(t){c=!0,a=t},f:function(){try{l||null==n["return"]||n["return"]()}finally{if(c)throw a}}}}var c=n("333d"),s=n("6988"),d=[{title:"RID",key:"rid",type:"text"},{title:"Store name",key:"StoreName",type:"text"},{title:"Brand name",key:"Brand",type:"text"},{title:"ASIN",key:"Asin",type:"text"},{title:"Price",key:"price",type:"text"},{title:"The products link",key:"ProductUrl",type:"text"},{title:"image",key:"ProductImgUrl",type:"image",widta:"100px",height:"100px"},{title:"order quantity",key:"quantity",type:"text"},{title:"KeyWord",key:"KeyWord",type:"text"},{title:"Special request",key:"xdyq",type:"text"}],u={name:"downloadTable",components:{Pagination:c["a"]},props:{rids:{type:String,default:""}},data:function(){return{tableData:[],pagination:{total:0,size:500,current:1},loading:!0,newrids:"",productTable:[]}},mounted:function(){this.newrids=this.rids,this.search()},methods:{search:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0!=e.length&&("current"==e[0]?this.pagination.current=e[1]:"size"==e[0]&&(this.pagination.size=e[1])),this.loading=!0,this.axios.get("/Handler/CPManageSystem.ashx?cmd=getExportCPOrderDetailList",{params:{pageSize:this.pagination.size,pageNum:this.pagination.current-1,rids:this.newrids}}).then((function(e){t.pagination.total=e.data.results,t.tableData=e.data.rows,t.loading=!1,t.tableData.filter((function(t){t.rid="is"+t.rid,t.quantity=1}))})).catch((function(t){}))},downTable:function(){Object(s["a"])(d,this.tableData,"放单表格.xls")},downTable1:function(){var t,e=this.tableData,n=[],r=l(e);try{var i=function(){var e=t.value;if(n.find((function(t){return t.Asin===e.Asin&&t.KeyWord===e.KeyWord})))return n.filter((function(t){t.Asin===e.Asin&&t.KeyWord===e.KeyWord&&t.quantity++})),"continue";n.push(e)};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}d.filter((function(t){return"rid"!=t.key})),Object(s["a"])(d,n,"放单表格.xls")}},watch:{rids:function(t,e){this.newrids=t}}},f=u,h=n("2877"),p=Object(h["a"])(f,r,i,!1,null,null,null);e["default"]=p.exports},"3ca3":function(t,e,n){"use strict";var r=n("6547").charAt,i=n("69f3"),a=n("7dd0"),o="String Iterator",l=i.set,c=i.getterFor(o);a(String,"String",(function(t){l(this,{type:o,string:String(t),index:0})}),(function(){var t,e=c(this),n=e.string,i=e.index;return i>=n.length?{value:void 0,done:!0}:(t=r(n,i),e.index+=t.length,{value:t,done:!1})}))},"4df4":function(t,e,n){"use strict";var r=n("0366"),i=n("7b0b"),a=n("9bdd"),o=n("e95a"),l=n("50c4"),c=n("8418"),s=n("35a1");t.exports=function(t){var e,n,d,u,f,h,p=i(t),y="function"==typeof this?this:Array,m=arguments.length,b=m>1?arguments[1]:void 0,g=void 0!==b,v=s(p),x=0;if(g&&(b=r(b,m>2?arguments[2]:void 0,2)),void 0==v||y==Array&&o(v))for(e=l(p.length),n=new y(e);e>x;x++)h=g?b(p[x],x):p[x],c(n,x,h);else for(u=v.call(p),f=u.next,n=new y;!(d=f.call(u)).done;x++)h=g?a(u,b,[d.value,x],!0):d.value,c(n,x,h);return n.length=x,n}},6547:function(t,e,n){var r=n("a691"),i=n("1d80"),a=function(t){return function(e,n){var a,o,l=String(i(e)),c=r(n),s=l.length;return c<0||c>=s?t?"":void 0:(a=l.charCodeAt(c),a<55296||a>56319||c+1===s||(o=l.charCodeAt(c+1))<56320||o>57343?t?l.charAt(c):a:t?l.slice(c,c+2):o-56320+(a-55296<<10)+65536)}};t.exports={codeAt:a(!1),charAt:a(!0)}},6988:function(t,e,n){"use strict";let r;const i=()=>{let t=window.navigator.userAgent;return t.indexOf("MSIE")>=0?"ie":t.indexOf("Firefox")>=0?"Firefox":t.indexOf("Chrome")>=0?"Chrome":t.indexOf("Opera")>=0?"Opera":t.indexOf("Safari")>=0?"Safari":void 0},a=(t,e)=>{"ie"==i()?o(t,e):l(t,e)},o=(t,e)=>{let n=t,i=new ActiveXObject("Excel.Application"),a=i.Workbooks.Add(),o=a.Worksheets(1),l=document.body.createTextRange();l.moveToElementText(n),l.select,l.execCommand("Copy"),o.Paste(),i.Visible=!0;try{let t=i.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(c){print("Nested catch caught "+c)}finally{a.SaveAs(t),a.Close(savechanges=!1),i.Quit(),i=null,window.setInterval("Cleanup();",1),r=window.setInterval("Cleanup();",1)}},l=function(){const t="data:application/vnd.ms-excel;base64,",e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',n=function(t){return window.btoa(unescape(encodeURIComponent(t)))},r=(t,e)=>t.replace(/{(\w+)}/g,(t,n)=>e[n]);return(i,a)=>{const o={worksheet:a,table:i},l=t+n(r(e,o));if(navigator.userAgent.indexOf("Firefox")>-1)window.location.href=l;else{const t=document.createElement("a");let e;t.href=l,t.download=a||"",window.MouseEvent?e=new MouseEvent("click"):(e=document.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),t.dispatchEvent(e)}}}(),c=(t,e,n)=>{const r={image:s,text:c};let i=t.reduce((t,e)=>(t+=`<th>${e.title}</th>`,t),"");i=`<thead><tr>${i}</tr></thead>`;let o=e.reduce((e,n)=>{const i=t.reduce((t,e)=>(t+=r[e.type||"text"](n[e.key],e),t),"");return e+=`<tr>${i}</tr>`,e},"");o=`<tbody>${o}</tbody>`;const l=i+o;function c(t){return`<td style="text-align: center">${t}</td>`}function s(t,e){return e=Object.assign({width:40,height:60},e),`<td style="width: ${e.width}px; height: ${e.height}px; text-align: center; vertical-align: middle"><img src="${t}" width=${e.width} height=${e.height}></td>`}a(l,n)};e["a"]=c},"7db0":function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").find,a=n("44d2"),o=n("ae40"),l="find",c=!0,s=o(l);l in[]&&Array(1)[l]((function(){c=!1})),r({target:"Array",proto:!0,forced:c||!s},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a(l)},a630:function(t,e,n){var r=n("23e7"),i=n("4df4"),a=n("1c7e"),o=!a((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:o},{from:i})},d28b:function(t,e,n){var r=n("746f");r("iterator")},ddb0:function(t,e,n){var r=n("da84"),i=n("fdbc"),a=n("e260"),o=n("9112"),l=n("b622"),c=l("iterator"),s=l("toStringTag"),d=a.values;for(var u in i){var f=r[u],h=f&&f.prototype;if(h){if(h[c]!==d)try{o(h,c,d)}catch(y){h[c]=d}if(h[s]||o(h,s,u),i[u])for(var p in a)if(h[p]!==a[p])try{o(h,p,a[p])}catch(y){h[p]=a[p]}}}},e01a:function(t,e,n){"use strict";var r=n("23e7"),i=n("83ab"),a=n("da84"),o=n("5135"),l=n("861d"),c=n("9bf2").f,s=n("e893"),d=a.Symbol;if(i&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var u={},f=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof f?new d(t):void 0===t?d():d(t);return""===t&&(u[e]=!0),e};s(f,d);var h=f.prototype=d.prototype;h.constructor=f;var p=h.toString,y="Symbol(test)"==String(d("test")),m=/^Symbol\((.*)\)[^)]+$/;c(h,"description",{configurable:!0,get:function(){var t=l(this)?this.valueOf():this,e=p.call(t);if(o(u,t))return"";var n=y?e.slice(7,-1):e.replace(m,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:f})}},fb6a:function(t,e,n){"use strict";var r=n("23e7"),i=n("861d"),a=n("e8b5"),o=n("23cb"),l=n("50c4"),c=n("fc6a"),s=n("8418"),d=n("b622"),u=n("1dde"),f=n("ae40"),h=u("slice"),p=f("slice",{ACCESSORS:!0,0:0,1:2}),y=d("species"),m=[].slice,b=Math.max;r({target:"Array",proto:!0,forced:!h||!p},{slice:function(t,e){var n,r,d,u=c(this),f=l(u.length),h=o(t,f),p=o(void 0===e?f:e,f);if(a(u)&&(n=u.constructor,"function"!=typeof n||n!==Array&&!a(n.prototype)?i(n)&&(n=n[y],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return m.call(u,h,p);for(r=new(void 0===n?Array:n)(b(p-h,0)),d=0;h<p;h++,d++)h in u&&s(r,d,u[h]);return r.length=d,r}})}}]);
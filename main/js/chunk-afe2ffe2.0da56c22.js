(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-afe2ffe2"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"333d":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.pagination.total>t.pagination.size,expression:"pagination.total>pagination.size"}],attrs:{background:"","current-page":t.pagination.current,"page-sizes":t.pagination.sizes,"page-size":t.pagination.size,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},i=[],s={name:"Pagination",props:{pagination:{type:Object,default:function(){return{size:20,current:0,total:0,sizes:[20,50,100,200]}}}},methods:{handleSizeChange:function(t){var e=["size",t];this.$emit("search",e)},handleCurrentChange:function(t){var e=["current",t];this.$emit("search",e)}}},o=s,r=n("2877"),l=Object(r["a"])(o,a,i,!1,null,null,null);e["a"]=l.exports},"3eaf":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.fromAccount}},[n("el-form-item",{attrs:{label:"员工姓名"}},[n("el-input",{attrs:{placeholder:""},model:{value:t.fromAccount.name,callback:function(e){t.$set(t.fromAccount,"name",e)},expression:"fromAccount.name"}})],1),n("el-form-item",{attrs:{label:"角色"}},[n("el-select",{model:{value:t.fromAccount.user,callback:function(e){t.$set(t.fromAccount,"user",e)},expression:"fromAccount.user"}},[n("el-option",{attrs:{label:"全部",value:""}}),t._l(t.roleList,(function(t){return n("el-option",{key:t.roleid,attrs:{label:t.rolename,value:t.roleid}})}))],2)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)],1),n("div",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.setAccountInfo()}}},[t._v("新建员工信息")])],1),n("div",{staticClass:"tableMag"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""}},[n("el-table-column",{attrs:{prop:"uname",label:"员工姓名","min-width":"3%"}}),n("el-table-column",{attrs:{prop:"jsid",label:"角色",formatter:t.userid,"min-width":"5%"}}),n("el-table-column",{attrs:{prop:"udlname",label:"登陆名","min-width":"6%"}}),n("el-table-column",{attrs:{prop:"cjsj",label:"创建时间","min-width":"6%"}}),n("el-table-column",{attrs:{prop:"xgsj",label:"修改时间","min-width":"5%"}}),n("el-table-column",{attrs:{prop:"zt",label:"状态","min-width":"6%"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-switch",{attrs:{"active-value":"1","inactive-value":"0","active-text":"启用","inactive-text":"禁用"},on:{change:function(n){return t.activation(e.row)}},model:{value:e.row.zt,callback:function(n){t.$set(e.row,"zt",n)},expression:"scope.row.zt"}})]}}])}),n("el-table-column",{attrs:{prop:"bz",label:"备注","min-width":"5%"}}),n("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"7%"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.setAccountInfo(e.row.uid)}}},[t._v("编辑")]),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.resetPass(e.row.uid)}}},[t._v("重置密码")]),3!=e.row.jsid?[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return t.delUser(e.row.uid)}}},[t._v("删除")])]:t._e()]}}])})],1)],1),n("Pagination",{staticClass:"pagination",attrs:{pagination:t.pagination},on:{search:t.search}}),n("el-dialog",{attrs:{title:"添加用户信息",visible:t.dialogUserInfo,width:"400px"},on:{"update:visible":function(e){t.dialogUserInfo=e}}},[n(t.userinfo,{tag:"component",attrs:{userID:t.userID,roleList:t.roleList},on:{dialogUserInfoToggle:t.dialogUserInfoToggle}})],1)],1)},i=[],s=(n("b0c0"),n("d3b7"),n("ac1f"),n("841c"),n("ef36")),o=n("333d"),r={name:"AccountInfo",components:{Pagination:o["a"]},data:function(){return{fromAccount:{name:"",user:""},tableData:[],pagination:{total:0,size:20,current:1},loading:!0,dialogUserInfo:!1,userID:"",userinfo:null,roleList:[]}},mounted:function(){this.getRoleList(),this.search()},methods:{getRoleList:function(){var t=this;0==this.roleList.length&&this.axios.get("/Handler/CPManageSystem.ashx?cmd=getCPRoles").then((function(e){0==e.data.results?t.$message({type:"warning",message:"获取角色信息失败!"}):t.roleList=e.data.rows})).catch((function(e){t.$message({type:"warning",message:"获取角色信息失败!"})}))},search:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0!=e.length&&("current"==e[0]?this.pagination.current=e[1]:"size"==e[0]&&(this.pagination.size=e[1])),this.loading=!0,this.axios.get("/Handler/CPManageSystem.ashx?cmd=getCPUserList",{params:{pageSize:this.pagination.size,pageNum:this.pagination.current-1,uname:this.fromAccount.name,ujs:this.fromAccount.user}}).then((function(e){0!=e.data.results&&(t.tableData=e.data.rows,t.pagination.total=e.data.results),t.loading=!1})).catch((function(t){}))},setAccountInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.userID=t,this.dialogUserInfo=!0,null==this.userinfo&&(this.userinfo=function(){return n.e("chunk-2d0bd949").then(n.bind(null,"2d34"))})},dialogUserInfoToggle:function(){this.dialogUserInfo=!1,this.search()},resetPass:function(t){var e=this;this.$alert("您确定要重置该员工账号登陆密码吗?","重置提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var n,a,i,o=Math.floor(999999*Math.random())+"";e.axios.get("/Handler/RSAKey.ashx?cmd=CreateRSAKey").then((function(r){0==r.data.rescode&&(n=r.data.strPublicKeyExponent,a=r.data.strPublicKeyModulus,i=Object(s["a"])(o,n,a),e.axios.get("/Handler/CPManageSystem.ashx?cmd=modifyCPUserPassword&userid="+t+"&newpass="+i).then((function(t){t.data.rescode>0?e.$alert("重置成功，新密码:"+o,"新密码",{confirmButtonText:"确定"}):e.$message({type:"warning",message:"重置密码失败!"})})).catch((function(t){e.$message({type:"warning",message:"重置密码失败!"})})))}))})).catch((function(){}))},activation:function(t){var e=this;this.axios.get("/Handler/CPManageSystem.ashx?cmd=JhCPUser&userid="+t.uid).then((function(t){t.data>0&&e.$message({type:"success",message:"切换成功!"})})).catch((function(t){e.$message({type:"warning",message:"删除失败!"})}))},delUser:function(t){var e=this;this.$alert("确认要删除选中的员工账号吗?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){e.axios.get("/Handler/CPManageSystem.ashx?cmd=delCPUsers&uIDs="+t).then((function(t){t.data>0?(e.$message({type:"success",message:"删除成功!"}),e.search()):e.$message({type:"warning",message:"删除失败,可能原因：该员工已操作过相关订单信息将无法删除!"})})).catch((function(t){e.$message({type:"warning",message:"删除失败!"})}))})).catch((function(){}))},userid:function(t,e){for(var n=0;n<this.roleList.length;n++)if(t.jsid==this.roleList[n].roleid)return this.roleList[n].rolename}}},l=r,c=n("2877"),u=Object(c["a"])(l,a,i,!1,null,null,null);e["default"]=u.exports},"841c":function(t,e,n){"use strict";var a=n("d784"),i=n("825a"),s=n("1d80"),o=n("129f"),r=n("14c3");a("search",1,(function(t,e,n){return[function(e){var n=s(this),a=void 0==e?void 0:e[t];return void 0!==a?a.call(e,n):new RegExp(e)[t](String(n))},function(t){var a=n(e,t,this);if(a.done)return a.value;var s=i(t),l=String(this),c=s.lastIndex;o(c,0)||(s.lastIndex=0);var u=r(s,l);return o(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]}))}}]);
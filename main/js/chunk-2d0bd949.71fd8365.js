(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bd949"],{"2d34":function(e,s,t){"use strict";t.r(s);var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-form",{ref:"user",attrs:{model:e.user,rules:e.userRule,"label-width":"80px","label-position":"top"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"员工姓名",prop:"Username"}},[t("el-input",{model:{value:e.user.Username,callback:function(s){e.$set(e.user,"Username",s)},expression:"user.Username"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"登陆名称",prop:"Loginname"}},[t("el-input",{attrs:{autocomplete:"new-password"},model:{value:e.user.Loginname,callback:function(s){e.$set(e.user,"Loginname",s)},expression:"user.Loginname"}})],1)],1),""==e.userid?[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"登陆密码",prop:"pass"}},[t("el-input",{attrs:{type:"password",autocomplete:"new-password"},model:{value:e.user.pass,callback:function(s){e.$set(e.user,"pass",s)},expression:"user.pass"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"确认密码",prop:"pass1"}},[t("el-input",{attrs:{type:"password"},model:{value:e.user.pass1,callback:function(s){e.$set(e.user,"pass1",s)},expression:"user.pass1"}})],1)],1)]:e._e(),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"角色",prop:"Roleid"}},[t("el-select",{attrs:{placeholder:"请选择用户角色"},model:{value:e.user.Roleid,callback:function(s){e.$set(e.user,"Roleid",s)},expression:"user.Roleid"}},e._l(e.roleList,(function(e){return t("el-option",{key:e.roleid,attrs:{label:e.rolename,value:e.roleid}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"备注",prop:"Remark"}},[t("el-input",{model:{value:e.user.Remark,callback:function(s){e.$set(e.user,"Remark",s)},expression:"user.Remark"}})],1)],1),t("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.btnLoading,"close-on-click-modal":"false"},on:{click:function(s){return e.submitForm("user")}}},[e._v("立即创建")]),t("el-button",{on:{click:function(s){return e.resetForm()}}},[e._v("重置")])],1)],1)],2)],1)},a=[],n=t("ef36"),i={name:"SetUserInfo",data:function(){var e=this,s=function(s,t,r){""===t?r(new Error("请再次输入密码")):t!==e.user.pass?r(new Error("两次输入密码不一致!")):r()};return{user:{Username:"",Loginname:"",pass:"",pass1:"",Roleid:"",Remark:""},userRule:{Username:[{required:!0,message:"请输入员工姓名",trigger:"blur"}],Loginname:[{required:!0,message:"请输入登陆名称",trigger:"blur"}],pass:[{required:!0,message:"请输入登陆密码",trigger:"blur"}],pass1:[{validator:s,trigger:"blur"}],Roleid:[{required:!0,message:"请选择角色",trigger:"change"}]},userid:"",btnLoading:!1}},props:{userID:{type:String,default:""},roleList:{type:Array,default:new Array},dialogUserInfoToggle:{type:Function,default:function(){}}},mounted:function(){this.userid=this.userID,this.getUserInfo()},methods:{getUserInfo:function(){var e=this;""!=this.userid?(this.axios.get("/Handler/CPManageSystem.ashx?cmd=getCPUserInfo&userid="+this.userid).then((function(s){for(var t in s.data)e.user[t]=s.data[t]})).catch((function(s){e.$message({type:"warning",message:"获取用户信息失败!"})})),this.user.pass="1",this.user.pass1="1"):(this.user.pass="",this.user.pass1="")},submitForm:function(e){var s=this;this.$refs[e].validate((function(e){var t,r,a,i,o=0;if(!e)return!1;s.btnLoading=!0,""!=s.userid?(o=s.userid,a="1",i="1",s.createAccount(o,a,i)):s.axios.get("/Handler/RSAKey.ashx?cmd=CreateRSAKey").then((function(e){0==e.data.rescode?(t=e.data.strPublicKeyExponent,r=e.data.strPublicKeyModulus,a=Object(n["a"])(s.user.pass,t,r),i=Object(n["a"])(s.user.pass,t,r),""!=a&&""!=i?s.createAccount(o,a,i):(s.$message({type:"warning",message:"创建加密数据失败!"}),s.btnLoading=!1)):(s.$message({type:"warning",message:"创建加密数据失败!"}),s.btnLoading=!1)})).catch((function(e){s.$message({type:"warning",message:"创建加密数据失败!"}),s.btnLoading=!1}))}))},createAccount:function(e,s,t){var r=this;this.axios.get("/Handler/CPManageSystem.ashx?cmd=addOrEditCPUser",{params:{uid:e,username:this.user.Username,loginname:this.user.Loginname,password:s,surepassword:t,roleid:this.user.Roleid,remark:this.user.Remark}}).then((function(e){1==e.data.rescode?(r.$message({type:"success",message:e.data.resdesc}),r.$emit("dialogUserInfoToggle")):r.$message({type:"warning",message:e.data.resdesc}),r.btnLoading=!1})).catch((function(e){r.$message({type:"warning",message:"员工账号创建出错"}),r.btnLoading=!1}))},resetForm:function(){this.$refs.user.resetFields()}},watch:{userID:function(e,s){this.resetForm(),this.userid=e,this.getUserInfo()}}},o=i,l=t("2877"),u=Object(l["a"])(o,r,a,!1,null,null,null);s["default"]=u.exports}}]);
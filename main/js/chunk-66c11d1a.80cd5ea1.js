(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66c11d1a"],{cb21:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.ifdata?a("el-form",{ref:"rebate",attrs:{model:e.rebate,rules:e.rebateRule,"label-width":"80px","label-position":"top"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"中介",prop:"agent"}},[a("el-select",{attrs:{placeholder:"请选择中介"},model:{value:e.rebate.agent,callback:function(t){e.$set(e.rebate,"agent",t)},expression:"rebate.agent"}},e._l(e.newAgentdata,(function(e){return a("el-option",{key:e.rid,attrs:{label:e.name,value:e.rid}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"开始时间",prop:"date1"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"开始时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.rebate.date1,callback:function(t){e.$set(e.rebate,"date1",t)},expression:"rebate.date1"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"结束时间",prop:"date2"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"开始时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.rebate.date2,callback:function(t){e.$set(e.rebate,"date2",t)},expression:"rebate.date2"}})],1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.searchAgent("rebate")}}},[e._v("搜索")])],1)],1)],1)],1):a("el-form",{ref:"agent",attrs:{model:e.agent,rules:e.agentRule,"label-width":"80px","label-position":"top"}},[a("h4",[e._v("中介“"+e._s(e.agentname)+"”在"+e._s(e.rebate.date1)+"至"+e._s(e.rebate.date2)+"的数据如下")]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"下单单数"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.agent.ordernum,callback:function(t){e.$set(e.agent,"ordernum",t)},expression:"agent.ordernum"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"单个下单佣金"}},[a("el-input",{model:{value:e.agent.orderyj,callback:function(t){e.$set(e.agent,"orderyj",t)},expression:"agent.orderyj"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"总的下单佣金"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.agent.totalorderyj,callback:function(t){e.$set(e.agent,"totalorderyj",t)},expression:"agent.totalorderyj"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"留评单数"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.agent.reviewnum,callback:function(t){e.$set(e.agent,"reviewnum",t)},expression:"agent.reviewnum"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"单个留评佣金"}},[a("el-input",{model:{value:e.agent.reviewyj,callback:function(t){e.$set(e.agent,"reviewyj",t)},expression:"agent.reviewyj"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"总的留评佣金"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.agent.totalreviewyj,callback:function(t){e.$set(e.agent,"totalreviewyj",t)},expression:"agent.totalreviewyj"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"总的返款佣金"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.agent.totalyj,callback:function(t){e.$set(e.agent,"totalyj",t)},expression:"agent.totalyj"}})],1)],1),a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.agent.remark,callback:function(t){e.$set(e.agent,"remark",t)},expression:"agent.remark"}})],1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:24}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.submithReate("agent")}}},[e._v("提交")])],1)],1)],1)],1)],1)},n=[],s=a("e598"),l=s["a"],o=a("2877"),i=Object(o["a"])(l,r,n,!1,null,null,null);t["default"]=i.exports},e598:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("4160"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b0c0"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_2__);__webpack_exports__["a"]={name:"AgentRebate",props:{agentdata:{type:Array,default:new Array}},data:function(){return{newAgentdata:[],rebate:{agent:"",date1:"",date2:""},rebateRule:{agent:[{required:!0,message:"请选择中介",trigger:"change"}]},agent:{ordernum:"",reviewnum:"",orderyj:"",reviewyj:"",totalorderyj:"",totalreviewyj:"",totalyj:"",DraftMaxMoney:0,remark:""},agentRule:{orderyj:[{pattern:/^\d+(\.\d+)?$/,message:"下单佣金必须为数字",trigger:"blur"}],reviewyj:[{pattern:/^\d+(\.\d+)?$/,message:"留评佣金必须为数字",trigger:"blur"}]},ifdata:!0,btnLoading:!1}},computed:{agentname:function(){var e,t=this;return this.newAgentdata.forEach((function(a){a.rid==t.rebate.agent&&(e=a.name)})),e}},mounted:function(){this.newAgentdata=this.agentdata},methods:{searchAgent:function(e){var t=this;this.$refs[e].validate((function(e){e&&(""==t.rebate.date1&&""==t.rebate.date2?t.$message({type:"warning",message:"两个时间都不能为空"}):(t.btnLoading=!0,t.axios.get("/Handler/CPManageSystem.ashx?cmd=searchBuyerZJYJ",{params:{zjid:t.rebate.agent,cxsjs:t.rebate.date1,cxsje:t.rebate.date2}}).then((function(e){t.btnLoading=!1,e.data.rescode>0?0==e.data.xdnum&&0==e.data.lpnum?t.$message({type:"warning",message:"您查询的数据为空！"}):(t.ifdata=!1,t.agent.ordernum=e.data.xdnum,t.agent.reviewnum=e.data.lpnum):t.$message({type:"warning",message:e.data.resdesc})})).catch((function(e){}))))}))},submithReate:function submithReate(agent){var _this3=this;this.$refs[agent].validate((function(valid){if(valid){if(""==_this3.agent.orderyj||""==_this3.agent.reviewyj)return _this3.$message({type:"warning",message:"返款金额不能为空,没有则填写0"}),!1;_this3.btnLoading=!0,_this3.axios.get("/Handler/CPManageSystem.ashx?cmd=getAgentOverDraftMaxMoney&zjid="+_this3.rebate.agent+"&ordermoney="+_this3.agent.totalyj).then((function(res){if(0==res.data)_this3.submitdata();else{_this3.rebate.DraftMaxMoney=res.data;var zfmoney=_this3.agent.totalyj-eval(data),txt="该中介还欠"+res.data+"美金;本次所需支付是"+_this3.agent.totalyj+"美金,减掉中介所欠还需支付"+zfmoney+"美金";_this3.$confirm(txt,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){_this3.submitdata()})).catch((function(){_this3.$message({type:"info",message:"已取消返款"})}))}}))}}))},submitdata:function(){var e=this;this.axios.get("/Handler/CPManageSystem.ashx",{params:{cmd:"comitBuyerZJYJFK",zjid:this.rebate.agent,cxsjs:this.rebate.date1,cxsje:this.rebate.date2,xdyjdj:this.agent.orderyj,lpyjdj:this.agent.reviewyj,remark:this.agent.remark,DraftMaxMoney:this.agent.DraftMaxMoney}}).then((function(t){t.data.rescode>0?(e.$message({type:"success",message:"提交成功"}),e.$emit("dialogToggle"),e.resetForm()):e.$message({type:"warning",message:"提交失败"}),e.btnLoading=!1})).catch((function(t){e.$message({type:"warning",message:"提交失败"}),e.btnLoading=!1}))}},watch:{agentdata:function(e,t){this.newAgentdata=e},"agent.orderyj":function agentOrderyj(newVal,oldVal){this.agent.totalorderyj=eval(this.agent.ordernum)*eval(newVal),this.agent.totalorderyj=this.agent.totalorderyj?this.agent.totalorderyj:0,this.agent.totalreviewyj=this.agent.totalreviewyj?this.agent.totalreviewyj:0,this.agent.totalyj=eval(this.agent.totalorderyj)+eval(this.agent.totalreviewyj)},"agent.reviewyj":function agentReviewyj(newVal,oldVal){this.agent.totalreviewyj=eval(this.agent.reviewnum)*eval(newVal),this.agent.totalorderyj=this.agent.totalorderyj?this.agent.totalorderyj:0,this.agent.totalreviewyj=this.agent.totalreviewyj?this.agent.totalreviewyj:0,this.agent.totalyj=eval(this.agent.totalorderyj)+eval(this.agent.totalreviewyj)}}}}}]);
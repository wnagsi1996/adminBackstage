(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29fea561"],{6988:function(e,t,a){"use strict";let r;const o=()=>{let e=window.navigator.userAgent;return e.indexOf("MSIE")>=0?"ie":e.indexOf("Firefox")>=0?"Firefox":e.indexOf("Chrome")>=0?"Chrome":e.indexOf("Opera")>=0?"Opera":e.indexOf("Safari")>=0?"Safari":void 0},n=(e,t)=>{"ie"==o()?l(e,t):i(e,t)},l=(e,t)=>{let a=e,o=new ActiveXObject("Excel.Application"),n=o.Workbooks.Add(),l=n.Worksheets(1),i=document.body.createTextRange();i.moveToElementText(a),i.select,i.execCommand("Copy"),l.Paste(),o.Visible=!0;try{let e=o.Application.GetSaveAsFilename("Excel.xls","Excel Spreadsheets (*.xls), *.xls")}catch(s){print("Nested catch caught "+s)}finally{n.SaveAs(e),n.Close(savechanges=!1),o.Quit(),o=null,window.setInterval("Cleanup();",1),r=window.setInterval("Cleanup();",1)}},i=function(){const e="data:application/vnd.ms-excel;base64,",t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',a=function(e){return window.btoa(unescape(encodeURIComponent(e)))},r=(e,t)=>e.replace(/{(\w+)}/g,(e,a)=>t[a]);return(o,n)=>{const l={worksheet:n,table:o},i=e+a(r(t,l));if(navigator.userAgent.indexOf("Firefox")>-1)window.location.href=i;else{const e=document.createElement("a");let t;e.href=i,e.download=n||"",window.MouseEvent?t=new MouseEvent("click"):(t=document.createEvent("MouseEvents"),t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),e.dispatchEvent(t)}}}(),s=(e,t,a)=>{const r={image:d,text:s};let o=e.reduce((e,t)=>(e+=`<th>${t.title}</th>`,e),"");o=`<thead><tr>${o}</tr></thead>`;let l=t.reduce((t,a)=>{const o=e.reduce((e,t)=>(e+=r[t.type||"text"](a[t.key],t),e),"");return t+=`<tr>${o}</tr>`,t},"");l=`<tbody>${l}</tbody>`;const i=o+l;function s(e){return`<td style="text-align: center">${e}</td>`}function d(e,t){return t=Object.assign({width:40,height:60},t),`<td style="width: ${t.width}px; height: ${t.height}px; text-align: center; vertical-align: middle"><img src="${e}" width=${t.width} height=${t.height}></td>`}n(i,a)};t["a"]=s},ed9e:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.fromorder}},[a("el-form-item",{attrs:{label:"创建时间"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"date1"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"开始时间"},model:{value:e.fromorder.date1,callback:function(t){e.$set(e.fromorder,"date1",t)},expression:"fromorder.date1"}})],1)],1),a("el-col",{staticClass:"line",attrs:{span:1}},[e._v("-")]),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"date2"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"结束时间"},model:{value:e.fromorder.date2,callback:function(t){e.$set(e.fromorder,"date2",t)},expression:"fromorder.date2"}})],1)],1)],1),a("el-form-item",[a("el-form-item",{attrs:{label:"客户",prop:"name"}},[a("el-select",{attrs:{filterable:"",remote:"",placeholder:"请输入关键词","remote-method":e.remoteMethod,loading:e.clearloading},model:{value:e.fromorder.name,callback:function(t){e.$set(e.fromorder,"name",t)},expression:"fromorder.name"}},e._l(e.sellerdata,(function(e){return a("el-option",{key:e.id,attrs:{label:e.cname,value:e.id}})})),1)],1)],1),a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询")])],1),a("el-button",{attrs:{type:"primary"},on:{click:e.downTable}},[e._v("下载订单表格")]),a("div",{staticClass:"tableMag"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"example",data:e.tableData,border:"",stripe:""}},[a("el-table-column",{attrs:{prop:"xdOrderno",label:"单号","min-width":"6%"}}),a("el-table-column",{attrs:{prop:"ProductImgUrl",label:"图片","min-width":"4%"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:e.row.ProductUrl,target:"_blank"}},[a("el-popover",{attrs:{placement:"right",width:"200",trigger:"hover",content:e.row.ProductTitle}},[a("img",{staticStyle:{width:"50px"},attrs:{slot:"reference",src:e.row.ProductImgUrl},slot:"reference"})])],1)]}}])}),a("el-table-column",{attrs:{prop:"realproductdj",label:"价格","min-width":"4%"}}),a("el-table-column",{attrs:{prop:"realxddate",label:"下单时间","min-width":"6%"}}),a("el-table-column",{attrs:{prop:"lpstate",label:"是否上评","min-width":"4%"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"!=t.row.lpstate?a("p",[e._v("已留评")]):a("p",[e._v("未留评")])]}}])}),a("el-table-column",{attrs:{prop:"lpurl",label:"留评链接","min-width":"10%"}})],1)],1),a("Pagination",{staticClass:"pagination",attrs:{pagination:e.pagination},on:{search:e.search}})],1)},o=[],n=(a("b0c0"),a("ac1f"),a("841c"),a("333d")),l=a("6988"),i=[{title:"单号",key:"xdOrderno",type:"text"},{title:"图片",key:"ProductImgUrl",type:"image",widta:"100px",height:"100px"},{title:"价格",key:"realproductdj",type:"text"},{title:"下单时间",key:"realxddate",type:"text"},{title:"是否上评",key:"lpstate",type:"text"},{title:"留评链接",key:"lpurl",type:"text"}],s={name:"downloadTable",components:{Pagination:n["a"]},props:{orderno:{type:String,default:""}},data:function(){return{tableData:[],pagination:{total:0,size:500,current:1},loading:!0,clearloading:!1,neworderno:"",productTable:[],sellerdata:[],fromorder:{name:"",date1:"",date2:""}}},mounted:function(){this.neworderno=this.orderno,this.search()},methods:{search:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0!=t.length&&("current"==t[0]?this.pagination.current=t[1]:"size"==t[0]&&(this.pagination.size=t[1])),this.loading=!0,this.axios.get("/Handler/CPManageSystem.ashx?cmd=getMJExportCPOrderDetailList",{params:{pageSize:this.pagination.size,pageNum:this.pagination.current-1,orderno:"",sjs:this.fromorder.date1,sje:this.fromorder.date2,sjid:this.fromorder.name}}).then((function(t){e.pagination.total=t.data.results,e.tableData=t.data.rows,e.loading=!1})).catch((function(e){}))},remoteMethod:function(e){var t=this;""!==e?(this.clearloading=!0,setTimeout((function(){t.axios.get("/Handler/CPManageSystem.ashx?cmd=getHzsjListBySjname&sjname="+e).then((function(e){""!=e.data&&(t.sellerdata=e.data,t.clearloading=!1)})).catch((function(e){}))}),200)):this.sellerdata=[]},downTable:function(){0==this.tableData.length?this.$message({type:"warning",message:"表格数据为空"}):Object(l["a"])(i,this.tableData,"订单表格数据.xls")}},watch:{orderno:function(e,t){this.neworderno=e,this.search()}}},d=s,c=a("2877"),m=Object(c["a"])(d,r,o,!1,null,null,null);t["default"]=m.exports}}]);